# ApolloScapeAuto数据集

- 数据集[git首页](https://github.com/ApolloScapeAuto/dataset-api/tree/master)
- [Apollo框架](https://apollo.baidu.com/)

## 1. 下载数据集

以Car Instance为例，从[官方git](https://github.com/ApolloScapeAuto/dataset-api/tree/master/car_instance#3-dataset-download)中下载sample data, training data和 testing data

### 1.1 三个数据集的区别：

- **数据量**：
  1. sample data 是 Apollo 数据集中最小的部分，仅包含少量数据，用于用户了解数据集的格式和内容。
  2. training data 是 Apollo 数据集的主体部分，用于训练机器学习模型。
  3. testing data 是 Apollo 数据集的一部分，用于评估机器学习模型的性能。
- **数据标注**：
  1. sample data 和 training data 都经过了完全的标注，包括图像、点云、激光雷达等数据的标注。
  2. testing data 部分数据经过了部分标注，用于评估机器学习模型的泛化能力。
- **数据分布**：
  1. sample data 和 training data 的数据分布与真实世界的数据分布相似
  2. testing data 的数据分布与真实世界的数据分布可能存在差异。

### 1.2 数据集各个文件夹的含义：

- `camera`：相机内参

- `car_models`：各个汽车模型，保存为.pkl格式

  >.pkl 文件是 Python 中用于序列化和反序列化 Python 对象的二进制文件格式。
  >
  >- 序列化是将对象转换为字节流的过程，以便将其保存到文件中。
  >- 反序列化是将字节流转换回对象的过程。

- `split`：2个.txt文件，定义哪些照片用于train或validate

- `cat_poses`：图片中标记好了的汽车位姿

- `images`：所有的图片，即数据集

- `ignore_mask`：是一个黑白的掩码mask，用来避免false positive错误(把负例"不属于目标类别的样本"识别为正例"属于目标类别的样本")。会指示哪些区域不需要进行3D建图.

  - 对于testing数据集：需要先用官方的render程序把掩码中识别到的车给prune掉

## 2. 官方提供的script

### 2.1准备工作

- git下载

  ```
  git clone git@github.com:ApolloScapeAuto/dataset-api.git
  ```

- 编译renender

  ```
  sudo bash install.sh
  ```

  - 注意要在conda环境，或主机pip装了那些第三方库才能用
  - 注意他们的install.sh是基于python2的，但我用的Python3所以要修改：
    1. 将[install.sh](https://github.com/Fernweh-yang/SLAM_Code_Learning/blob/main/Apollo-dataset-api/car_instance/install.sh)中的python改为python3
    2. 修改[setup.py](https://github.com/Fernweh-yang/SLAM_Code_Learning/blob/main/Apollo-dataset-api/car_instance/renderer/setup.py)中byte类型转str类型字符串的写法

### 2.2 scripts

- `demo.ipynb` Demo function for visualization of an labelled image

- `car_models.py` central file defining the IDs of all semantic classes and providing mapping between various class properties.

- `render_car_instances.py` script for loading image and render image file

  - 将下载的数据集放在`../apolloscape/`文件夹下

  - 展示渲染结果

    ```shell
    python render_car_instances.py --split='sample_data' --image_name='180116_053947113_Camera_5' --data_dir='../apolloscape/3d_car_instance_sample'
    ```

- `renderer文件夹` containing scripts of python wrapper for opengl render a car model from a 3d car mesh. We borrow portion of opengl rendering from [Displets](http://www.cvlibs.net/projects/displets/) and change to egl offscreen render context and python api.
- `install.sh` installation script of this library.